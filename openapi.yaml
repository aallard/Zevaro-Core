openapi: 3.0.3
info:
  title: Zevaro Core API
  description: Decision management platform for product teams.
  version: 1.0.0
  contact:
    name: Zevaro Labs
    email: adam@zevarolabs.com

servers:
  - url: http://localhost:8080/api/v1
    description: Local development

security:
  - bearerAuth: []

tags:
  - name: Auth
    description: Authentication and registration
  - name: Projects
    description: Project management
  - name: Outcomes
    description: Outcome tracking and validation
  - name: Key Results
    description: Key results for outcomes
  - name: Hypotheses
    description: Hypothesis lifecycle management
  - name: Decisions
    description: Decision tracking and resolution
  - name: Decision Queues
    description: Decision queue management
  - name: Experiments
    description: Experiment lifecycle management
  - name: Teams
    description: Team and member management
  - name: Stakeholders
    description: Stakeholder management and metrics
  - name: Users
    description: User management
  - name: Roles
    description: Role-based access control
  - name: Audit
    description: Audit log access

paths:
  # ── Auth ──────────────────────────────────────────────
  /auth/login:
    post:
      tags: [Auth]
      summary: Authenticate with email and password.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Invalid credentials
        '429':
          description: Rate limit exceeded

  /auth/register:
    post:
      tags: [Auth]
      summary: Register a new user and tenant.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: Registration successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '429':
          description: Rate limit exceeded

  /auth/refresh:
    post:
      tags: [Auth]
      summary: Refresh an expired access token.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
      responses:
        '200':
          description: Token refreshed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '429':
          description: Rate limit exceeded

  /auth/logout:
    post:
      tags: [Auth]
      summary: Logout the current user.
      responses:
        '204':
          description: Logged out

  # ── Projects ──────────────────────────────────────────
  /projects:
    get:
      tags: [Projects]
      summary: List all projects for the tenant.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/ProjectStatus'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectResponse'
    post:
      tags: [Projects]
      summary: Create a new project.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProjectRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectResponse'

  /projects/paged:
    get:
      tags: [Projects]
      summary: List projects with pagination.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/ProjectStatus'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/size'
        - $ref: '#/components/parameters/sortBy'
        - $ref: '#/components/parameters/sortDir'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageProjectResponse'

  /projects/{id}:
    get:
      tags: [Projects]
      summary: Get a project by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectResponse'
        '404':
          description: Not found
    put:
      tags: [Projects]
      summary: Update a project.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProjectRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectResponse'
    delete:
      tags: [Projects]
      summary: Delete a project.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /projects/{id}/stats:
    get:
      tags: [Projects]
      summary: Get project statistics.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectStatsResponse'

  /projects/{id}/dashboard:
    get:
      tags: [Projects]
      summary: Get project dashboard data.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectDashboardResponse'

  # ── Outcomes ──────────────────────────────────────────
  /outcomes:
    get:
      tags: [Outcomes]
      summary: List outcomes with optional filters.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/OutcomeStatus'
        - name: teamId
          in: query
          schema:
            type: string
            format: uuid
        - name: priority
          in: query
          schema:
            $ref: '#/components/schemas/OutcomePriority'
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OutcomeResponse'
    post:
      tags: [Outcomes]
      summary: Create a new outcome.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOutcomeRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/paged:
    get:
      tags: [Outcomes]
      summary: List outcomes with pagination.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/OutcomeStatus'
        - name: teamId
          in: query
          schema:
            type: string
            format: uuid
        - name: priority
          in: query
          schema:
            $ref: '#/components/schemas/OutcomePriority'
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/size'
        - $ref: '#/components/parameters/sortBy'
        - $ref: '#/components/parameters/sortDir'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageOutcomeResponse'

  /outcomes/{id}:
    get:
      tags: [Outcomes]
      summary: Get an outcome by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'
    put:
      tags: [Outcomes]
      summary: Update an outcome.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOutcomeRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'
    delete:
      tags: [Outcomes]
      summary: Delete an outcome.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /outcomes/my-outcomes:
    get:
      tags: [Outcomes]
      summary: Get outcomes owned by the current user.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/team/{teamId}:
    get:
      tags: [Outcomes]
      summary: Get outcomes for a specific team.
      parameters:
        - name: teamId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/overdue:
    get:
      tags: [Outcomes]
      summary: Get overdue outcomes.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/{id}/start:
    post:
      tags: [Outcomes]
      summary: Start tracking an outcome.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/{id}/validate:
    post:
      tags: [Outcomes]
      summary: Mark an outcome as validated.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ValidateOutcomeRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/{id}/invalidate:
    post:
      tags: [Outcomes]
      summary: Mark an outcome as invalidated.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InvalidateOutcomeRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/{id}/abandon:
    post:
      tags: [Outcomes]
      summary: Abandon an outcome with a reason.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: reason
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/{id}/metrics:
    patch:
      tags: [Outcomes]
      summary: Update current metrics for an outcome.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutcomeResponse'

  /outcomes/stats:
    get:
      tags: [Outcomes]
      summary: Get outcome counts grouped by status.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: integer
                  format: int64

  # ── Key Results ───────────────────────────────────────
  /outcomes/{outcomeId}/key-results:
    get:
      tags: [Key Results]
      summary: List key results for an outcome.
      parameters:
        - $ref: '#/components/parameters/outcomeId'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KeyResultResponse'
    post:
      tags: [Key Results]
      summary: Create a key result for an outcome.
      parameters:
        - $ref: '#/components/parameters/outcomeId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKeyResultRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeyResultResponse'

  /outcomes/{outcomeId}/key-results/{id}:
    get:
      tags: [Key Results]
      summary: Get a key result by ID.
      parameters:
        - $ref: '#/components/parameters/outcomeId'
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeyResultResponse'
    put:
      tags: [Key Results]
      summary: Update a key result.
      parameters:
        - $ref: '#/components/parameters/outcomeId'
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateKeyResultRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeyResultResponse'
    delete:
      tags: [Key Results]
      summary: Delete a key result.
      parameters:
        - $ref: '#/components/parameters/outcomeId'
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /outcomes/{outcomeId}/key-results/{id}/progress:
    post:
      tags: [Key Results]
      summary: Update progress value for a key result.
      parameters:
        - $ref: '#/components/parameters/outcomeId'
        - $ref: '#/components/parameters/id'
        - name: value
          in: query
          required: true
          schema:
            type: number
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeyResultResponse'

  # ── Hypotheses ────────────────────────────────────────
  /hypotheses:
    get:
      tags: [Hypotheses]
      summary: List hypotheses with optional filters.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/HypothesisStatus'
        - name: outcomeId
          in: query
          schema:
            type: string
            format: uuid
        - name: priority
          in: query
          schema:
            $ref: '#/components/schemas/HypothesisPriority'
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/HypothesisResponse'
    post:
      tags: [Hypotheses]
      summary: Create a new hypothesis.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateHypothesisRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/paged:
    get:
      tags: [Hypotheses]
      summary: List hypotheses with pagination.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/HypothesisStatus'
        - name: priority
          in: query
          schema:
            $ref: '#/components/schemas/HypothesisPriority'
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/size'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageHypothesisResponse'

  /hypotheses/{id}:
    get:
      tags: [Hypotheses]
      summary: Get a hypothesis by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HypothesisResponse'
    put:
      tags: [Hypotheses]
      summary: Update a hypothesis.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHypothesisRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HypothesisResponse'
    delete:
      tags: [Hypotheses]
      summary: Delete a hypothesis.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /hypotheses/my-hypotheses:
    get:
      tags: [Hypotheses]
      summary: Get hypotheses owned by the current user.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/outcome/{outcomeId}:
    get:
      tags: [Hypotheses]
      summary: Get hypotheses linked to an outcome.
      parameters:
        - $ref: '#/components/parameters/outcomeIdPath'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/blocked:
    get:
      tags: [Hypotheses]
      summary: Get all blocked hypotheses.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/active:
    get:
      tags: [Hypotheses]
      summary: Get all active hypotheses.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/{id}/transition:
    post:
      tags: [Hypotheses]
      summary: Transition a hypothesis to a new status.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TransitionHypothesisRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/{id}/conclude:
    post:
      tags: [Hypotheses]
      summary: Conclude a hypothesis with results.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConcludeHypothesisRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/{id}/abandon:
    post:
      tags: [Hypotheses]
      summary: Abandon a hypothesis with a reason.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: reason
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HypothesisResponse'

  /hypotheses/stats:
    get:
      tags: [Hypotheses]
      summary: Get hypothesis counts grouped by status.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: integer
                  format: int64

  /hypotheses/outcome/{outcomeId}/stats:
    get:
      tags: [Hypotheses]
      summary: Get hypothesis status counts for an outcome.
      parameters:
        - $ref: '#/components/parameters/outcomeIdPath'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: integer
                  format: int64

  # ── Decisions ─────────────────────────────────────────
  /decisions:
    get:
      tags: [Decisions]
      summary: List decisions with optional filters.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/DecisionStatus'
        - name: priority
          in: query
          schema:
            $ref: '#/components/schemas/DecisionPriority'
        - name: type
          in: query
          schema:
            $ref: '#/components/schemas/DecisionType'
        - name: teamId
          in: query
          schema:
            type: string
            format: uuid
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'
    post:
      tags: [Decisions]
      summary: Create a new decision.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDecisionRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/paged:
    get:
      tags: [Decisions]
      summary: List decisions with pagination.
      parameters:
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/DecisionStatus'
        - name: priority
          in: query
          schema:
            $ref: '#/components/schemas/DecisionPriority'
        - name: type
          in: query
          schema:
            $ref: '#/components/schemas/DecisionType'
        - name: teamId
          in: query
          schema:
            type: string
            format: uuid
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/size'
        - $ref: '#/components/parameters/sortBy'
        - $ref: '#/components/parameters/sortDir'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageDecisionResponse'

  /decisions/{id}:
    get:
      tags: [Decisions]
      summary: Get a decision by ID with optional includes.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: includeVotes
          in: query
          schema:
            type: boolean
            default: false
        - name: includeComments
          in: query
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'
    put:
      tags: [Decisions]
      summary: Update a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDecisionRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'
    delete:
      tags: [Decisions]
      summary: Delete a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /decisions/queue:
    get:
      tags: [Decisions]
      summary: Get the decision queue overview.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionQueueResponse'

  /decisions/my-pending:
    get:
      tags: [Decisions]
      summary: Get decisions pending for the current user.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'

  /decisions/pending:
    get:
      tags: [Decisions]
      summary: Get all pending decisions, optionally by team.
      parameters:
        - name: teamId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'

  /decisions/blocking:
    get:
      tags: [Decisions]
      summary: Get decisions that are blocking work.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'

  /decisions/overdue:
    get:
      tags: [Decisions]
      summary: Get overdue decisions.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'

  /decisions/outcome/{outcomeId}:
    get:
      tags: [Decisions]
      summary: Get decisions linked to an outcome.
      parameters:
        - $ref: '#/components/parameters/outcomeIdPath'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'

  /decisions/hypothesis/{hypothesisId}:
    get:
      tags: [Decisions]
      summary: Get decisions linked to a hypothesis.
      parameters:
        - name: hypothesisId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/start-discussion:
    post:
      tags: [Decisions]
      summary: Move a decision to discussion status.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/resolve:
    post:
      tags: [Decisions]
      summary: Resolve a decision with a rationale.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResolveDecisionRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/implement:
    post:
      tags: [Decisions]
      summary: Mark a decision as implemented.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/defer:
    post:
      tags: [Decisions]
      summary: Defer a decision with a reason.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: reason
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/cancel:
    post:
      tags: [Decisions]
      summary: Cancel a decision with a reason.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: reason
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/reopen:
    post:
      tags: [Decisions]
      summary: Reopen a closed decision.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/escalate:
    post:
      tags: [Decisions]
      summary: Escalate a decision to another user.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EscalateDecisionRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/assign:
    post:
      tags: [Decisions]
      summary: Assign a decision to a user.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: assigneeId
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/reassign:
    post:
      tags: [Decisions]
      summary: Reassign a decision to a different user.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: newAssigneeId
          in: query
          required: true
          schema:
            type: string
            format: uuid
        - name: reason
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DecisionResponse'

  /decisions/{id}/comments:
    get:
      tags: [Decisions]
      summary: Get comments on a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CommentResponse'
    post:
      tags: [Decisions]
      summary: Add a comment to a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCommentRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponse'

  /decisions/{id}/comments/{commentId}:
    put:
      tags: [Decisions]
      summary: Update a comment on a decision.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: commentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCommentRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommentResponse'
    delete:
      tags: [Decisions]
      summary: Delete a comment on a decision.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: commentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Deleted

  /decisions/stats:
    get:
      tags: [Decisions]
      summary: Get decision counts grouped by status.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: integer
                  format: int64

  /decisions/metrics/avg-time:
    get:
      tags: [Decisions]
      summary: Get average decision resolution time in hours.
      parameters:
        - name: days
          in: query
          schema:
            type: integer
            default: 30
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: number
                format: double

  /decisions/{id}/votes:
    get:
      tags: [Decisions]
      summary: Get votes on a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/VoteResponse'
    post:
      tags: [Decisions]
      summary: Cast a vote on a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CastVoteRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VoteResponse'
    delete:
      tags: [Decisions]
      summary: Remove your vote from a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /decisions/{id}/votes/summary:
    get:
      tags: [Decisions]
      summary: Get vote summary for a decision.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VoteSummary'

  # ── Decision Queues ───────────────────────────────────
  /queues:
    get:
      tags: [Decision Queues]
      summary: List all decision queues.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/QueueResponse'
    post:
      tags: [Decision Queues]
      summary: Create a new decision queue.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateQueueRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueueResponse'

  /queues/{id}:
    get:
      tags: [Decision Queues]
      summary: Get a queue by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueueResponse'
    put:
      tags: [Decision Queues]
      summary: Update a queue.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateQueueRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueueResponse'
    delete:
      tags: [Decision Queues]
      summary: Delete a queue.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /queues/default:
    get:
      tags: [Decision Queues]
      summary: Get the default queue.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueueResponse'
        '404':
          description: No default queue configured

  /queues/{id}/set-default:
    post:
      tags: [Decision Queues]
      summary: Set a queue as the default.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueueResponse'

  # ── Experiments ───────────────────────────────────────
  /experiments:
    get:
      tags: [Experiments]
      summary: List experiments with optional filters.
      parameters:
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/ExperimentStatus'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ExperimentResponse'
    post:
      tags: [Experiments]
      summary: Create a new experiment.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateExperimentRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'

  /experiments/paged:
    get:
      tags: [Experiments]
      summary: List experiments with pagination.
      parameters:
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/ExperimentStatus'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/size'
        - $ref: '#/components/parameters/sortBy'
        - $ref: '#/components/parameters/sortDir'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageExperimentResponse'

  /experiments/{id}:
    get:
      tags: [Experiments]
      summary: Get an experiment by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'
    put:
      tags: [Experiments]
      summary: Update an experiment.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateExperimentRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'
    delete:
      tags: [Experiments]
      summary: Delete an experiment.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /experiments/{id}/start:
    post:
      tags: [Experiments]
      summary: Start running an experiment.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'

  /experiments/{id}/conclude:
    post:
      tags: [Experiments]
      summary: Conclude an experiment with findings.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: conclusion
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'

  /experiments/{id}/cancel:
    post:
      tags: [Experiments]
      summary: Cancel a running experiment.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'

  /experiments/{id}/extend:
    post:
      tags: [Experiments]
      summary: Extend an experiment's duration.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: additionalDays
          in: query
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'

  /experiments/{id}/results:
    post:
      tags: [Experiments]
      summary: Record results for an experiment.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecordResultsRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExperimentResponse'

  /experiments/hypothesis/{hypothesisId}:
    get:
      tags: [Experiments]
      summary: Get experiments linked to a hypothesis.
      parameters:
        - name: hypothesisId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ExperimentResponse'

  # ── Teams ─────────────────────────────────────────────
  /teams:
    get:
      tags: [Teams]
      summary: List all teams.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TeamResponse'
    post:
      tags: [Teams]
      summary: Create a new team.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTeamRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamResponse'

  /teams/paged:
    get:
      tags: [Teams]
      summary: List teams with pagination.
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/size'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageTeamResponse'

  /teams/{id}:
    get:
      tags: [Teams]
      summary: Get team details by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamDetailResponse'
    put:
      tags: [Teams]
      summary: Update a team.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTeamRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamResponse'
    delete:
      tags: [Teams]
      summary: Delete a team.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /teams/slug/{slug}:
    get:
      tags: [Teams]
      summary: Get team details by slug.
      parameters:
        - name: slug
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamDetailResponse'

  /teams/my-teams:
    get:
      tags: [Teams]
      summary: Get teams the current user belongs to.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TeamResponse'

  /teams/{id}/members:
    get:
      tags: [Teams]
      summary: List members of a team.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TeamMemberResponse'
    post:
      tags: [Teams]
      summary: Add a member to a team.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddTeamMemberRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamMemberResponse'

  /teams/{id}/members/{userId}:
    put:
      tags: [Teams]
      summary: Update a team member's role.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTeamMemberRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamMemberResponse'
    delete:
      tags: [Teams]
      summary: Remove a member from a team.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Removed

  /teams/{id}/workload:
    get:
      tags: [Teams]
      summary: Get workload distribution for a team.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamWorkloadResponse'

  # ── Stakeholders ──────────────────────────────────────
  /stakeholders:
    get:
      tags: [Stakeholders]
      summary: List stakeholders with optional filters.
      parameters:
        - name: type
          in: query
          schema:
            $ref: '#/components/schemas/StakeholderType'
        - name: activeOnly
          in: query
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StakeholderResponse'
    post:
      tags: [Stakeholders]
      summary: Create a new stakeholder.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateStakeholderRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderResponse'

  /stakeholders/{id}:
    get:
      tags: [Stakeholders]
      summary: Get a stakeholder by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderResponse'
    put:
      tags: [Stakeholders]
      summary: Update a stakeholder.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateStakeholderRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderResponse'
    delete:
      tags: [Stakeholders]
      summary: Delete a stakeholder.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deleted

  /stakeholders/email/{email}:
    get:
      tags: [Stakeholders]
      summary: Find a stakeholder by email.
      parameters:
        - name: email
          in: path
          required: true
          schema:
            type: string
            format: email
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderResponse'

  /stakeholders/with-pending:
    get:
      tags: [Stakeholders]
      summary: Get stakeholders who have pending decisions.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StakeholderResponse'

  /stakeholders/slow-responders:
    get:
      tags: [Stakeholders]
      summary: Get stakeholders with slow response times.
      parameters:
        - name: thresholdHours
          in: query
          schema:
            type: number
            format: double
            default: 24
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StakeholderResponse'

  /stakeholders/search/expertise:
    get:
      tags: [Stakeholders]
      summary: Find stakeholders by area of expertise.
      parameters:
        - name: expertise
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StakeholderResponse'

  /stakeholders/{id}/metrics:
    get:
      tags: [Stakeholders]
      summary: Get decision metrics for a stakeholder.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderMetrics'

  /stakeholders/{id}/stats:
    get:
      tags: [Stakeholders]
      summary: Get statistics for a stakeholder.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderMetrics'

  /stakeholders/{id}/responses:
    get:
      tags: [Stakeholders]
      summary: Get paginated decision responses for a stakeholder.
      parameters:
        - $ref: '#/components/parameters/id'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/size'
        - name: pending
          in: query
          schema:
            type: boolean
        - name: withinSla
          in: query
          schema:
            type: boolean
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageDecisionResponse'

  /stakeholders/leaderboard:
    get:
      tags: [Stakeholders]
      summary: Get stakeholder performance leaderboard.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderLeaderboard'

  /stakeholders/me/responses/pending:
    get:
      tags: [Stakeholders]
      summary: Get pending decision responses for the current user.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DecisionResponse'

  /stakeholders/scorecard:
    get:
      tags: [Stakeholders]
      summary: Get stakeholder scorecard, optionally by project.
      parameters:
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StakeholderScorecardResponse'

  # ── Users ─────────────────────────────────────────────
  /users:
    get:
      tags: [Users]
      summary: List all users in the tenant.
      parameters:
        - name: department
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserResponse'

  /users/{id}:
    get:
      tags: [Users]
      summary: Get a user by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
    put:
      tags: [Users]
      summary: Update a user.
      parameters:
        - $ref: '#/components/parameters/id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'
    delete:
      tags: [Users]
      summary: Deactivate a user.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '204':
          description: Deactivated

  /users/me:
    get:
      tags: [Users]
      summary: Get the current authenticated user.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'

  /users/{id}/direct-reports:
    get:
      tags: [Users]
      summary: Get direct reports for a user.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserResponse'

  /users/{id}/role:
    put:
      tags: [Users]
      summary: Assign a role to a user.
      parameters:
        - $ref: '#/components/parameters/id'
        - name: roleId
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserResponse'

  # ── Roles ─────────────────────────────────────────────
  /roles:
    get:
      tags: [Roles]
      summary: List available roles for the tenant.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RoleResponse'
    post:
      tags: [Roles]
      summary: Create a custom role.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRoleRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoleResponse'

  /roles/{id}:
    get:
      tags: [Roles]
      summary: Get a role by ID.
      parameters:
        - $ref: '#/components/parameters/id'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoleResponse'

  /roles/categories:
    get:
      tags: [Roles]
      summary: List all role categories.
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RoleCategory'

  # ── Audit ─────────────────────────────────────────────
  /audit:
    get:
      tags: [Audit]
      summary: Search audit logs with filters.
      parameters:
        - name: actorId
          in: query
          schema:
            type: string
            format: uuid
        - name: entityType
          in: query
          schema:
            type: string
        - name: entityId
          in: query
          schema:
            type: string
            format: uuid
        - name: action
          in: query
          schema:
            $ref: '#/components/schemas/AuditAction'
        - $ref: '#/components/parameters/page'
        - name: size
          in: query
          schema:
            type: integer
            default: 50
        - name: sort
          in: query
          schema:
            type: string
            default: timestamp,desc
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageAuditLog'

  /audit/entity/{entityType}/{entityId}:
    get:
      tags: [Audit]
      summary: Get audit history for a specific entity.
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
        - name: entityId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/page'
        - name: size
          in: query
          schema:
            type: integer
            default: 50
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageAuditLog'

  /audit/stats:
    get:
      tags: [Audit]
      summary: Get audit action counts for a time period.
      parameters:
        - name: days
          in: query
          schema:
            type: integer
            default: 30
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: integer
                  format: int64

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  parameters:
    id:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
    outcomeId:
      name: outcomeId
      in: path
      required: true
      schema:
        type: string
        format: uuid
    outcomeIdPath:
      name: outcomeId
      in: path
      required: true
      schema:
        type: string
        format: uuid
    page:
      name: page
      in: query
      schema:
        type: integer
        default: 0
    size:
      name: size
      in: query
      schema:
        type: integer
        default: 20
    sortBy:
      name: sortBy
      in: query
      schema:
        type: string
        default: createdAt
    sortDir:
      name: sortDir
      in: query
      schema:
        type: string
        enum: [asc, desc]
        default: desc

  schemas:
    # ── Auth ──────────────────────────────────────────
    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
        password:
          type: string

    RegisterRequest:
      type: object
      required: [email, password, firstName, lastName, tenantName]
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
        firstName:
          type: string
        lastName:
          type: string
        tenantName:
          type: string

    RefreshTokenRequest:
      type: object
      required: [refreshToken]
      properties:
        refreshToken:
          type: string

    AuthResponse:
      type: object
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
        tokenType:
          type: string
        expiresIn:
          type: integer
        user:
          $ref: '#/components/schemas/AuthUserInfo'

    AuthUserInfo:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        tenantId:
          type: string
        roles:
          type: array
          items:
            type: string
        permissions:
          type: array
          items:
            type: string

    # ── Shared ────────────────────────────────────────
    UserSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        fullName:
          type: string
        title:
          type: string
        avatarUrl:
          type: string

    ProjectSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        slug:
          type: string
        status:
          $ref: '#/components/schemas/ProjectStatus'
        color:
          type: string

    TeamSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        slug:
          type: string
        color:
          type: string

    OutcomeSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        status:
          $ref: '#/components/schemas/OutcomeStatus'
        priority:
          $ref: '#/components/schemas/OutcomePriority'
        targetDate:
          type: string
          format: date

    HypothesisSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        status:
          $ref: '#/components/schemas/HypothesisStatus'
        priority:
          $ref: '#/components/schemas/HypothesisPriority'

    QueueSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string

    StakeholderSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
        title:
          type: string
        organization:
          type: string
        type:
          $ref: '#/components/schemas/StakeholderType'

    DecisionSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        status:
          $ref: '#/components/schemas/DecisionStatus'
        priority:
          $ref: '#/components/schemas/DecisionPriority'
        waitTimeHours:
          type: integer
          format: int64
        overdue:
          type: boolean
        assignedTo:
          $ref: '#/components/schemas/UserSummary'

    # ── Projects ──────────────────────────────────────
    CreateProjectRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 255
        description:
          type: string
          maxLength: 5000
        status:
          $ref: '#/components/schemas/ProjectStatus'
        color:
          type: string
          maxLength: 7
        ownerId:
          type: string
          format: uuid

    UpdateProjectRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 255
        description:
          type: string
          maxLength: 5000
        status:
          $ref: '#/components/schemas/ProjectStatus'
        color:
          type: string
          maxLength: 7
        ownerId:
          type: string
          format: uuid
        iconUrl:
          type: string

    ProjectResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        slug:
          type: string
        description:
          type: string
        status:
          $ref: '#/components/schemas/ProjectStatus'
        color:
          type: string
        iconUrl:
          type: string
        owner:
          $ref: '#/components/schemas/UserSummary'
        decisionCount:
          type: integer
        outcomeCount:
          type: integer
        hypothesisCount:
          type: integer
        teamMemberCount:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    ProjectStatsResponse:
      type: object
      properties:
        pendingDecisionCount:
          type: integer
        activeOutcomeCount:
          type: integer
        runningExperimentCount:
          type: integer
        totalHypothesisCount:
          type: integer

    ProjectDashboardResponse:
      type: object
      properties:
        pendingDecisionCount:
          type: integer
        slaBreachedDecisionCount:
          type: integer
        activeOutcomeCount:
          type: integer
        outcomeValidationPercentage:
          type: number
          format: double
        runningExperimentCount:
          type: integer
        avgDecisionTimeHours:
          type: number
          format: double
        avgDecisionTimeTrend:
          type: number
          format: double
        urgentDecisions:
          type: array
          items:
            $ref: '#/components/schemas/DashboardDecisionQueueItem'
        decisionVelocity:
          type: array
          items:
            $ref: '#/components/schemas/DashboardDailyMetric'
        outcomeProgress:
          type: array
          items:
            $ref: '#/components/schemas/DashboardOutcomeProgressItem'
        recentActivity:
          type: array
          items:
            $ref: '#/components/schemas/DashboardActivityItem'

    DashboardDecisionQueueItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        priority:
          type: string
        assigneeName:
          type: string
        assigneeAvatarUrl:
          type: string
        waitingMinutes:
          type: integer
          format: int64
        slaBreached:
          type: boolean

    DashboardDailyMetric:
      type: object
      properties:
        date:
          type: string
          format: date
        count:
          type: integer
        avgHours:
          type: number
          format: double

    DashboardOutcomeProgressItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        status:
          type: string
        progressPercent:
          type: number
          format: double
        color:
          type: string

    DashboardActivityItem:
      type: object
      properties:
        actorName:
          type: string
        actorAvatarUrl:
          type: string
        action:
          type: string
        entityType:
          type: string
        entityTitle:
          type: string
        timestamp:
          type: string
          format: date-time

    # ── Outcomes ──────────────────────────────────────
    CreateOutcomeRequest:
      type: object
      required: [title, successCriteria]
      properties:
        title:
          type: string
          minLength: 3
          maxLength: 500
        description:
          type: string
          maxLength: 5000
        successCriteria:
          type: string
          maxLength: 2000
        targetMetrics:
          type: object
          additionalProperties: true
        priority:
          $ref: '#/components/schemas/OutcomePriority'
        teamId:
          type: string
          format: uuid
        ownerId:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        targetDate:
          type: string
          format: date
        tags:
          type: array
          maxItems: 20
          items:
            type: string

    UpdateOutcomeRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 500
        description:
          type: string
        successCriteria:
          type: string
        targetMetrics:
          type: object
          additionalProperties: true
        currentMetrics:
          type: object
          additionalProperties: true
        priority:
          $ref: '#/components/schemas/OutcomePriority'
        teamId:
          type: string
          format: uuid
        ownerId:
          type: string
          format: uuid
        targetDate:
          type: string
          format: date
        tags:
          type: array
          items:
            type: string
        externalRefs:
          type: object
          additionalProperties:
            type: string

    OutcomeResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        description:
          type: string
        successCriteria:
          type: string
        targetMetrics:
          type: object
          additionalProperties: true
        currentMetrics:
          type: object
          additionalProperties: true
        status:
          $ref: '#/components/schemas/OutcomeStatus'
        priority:
          $ref: '#/components/schemas/OutcomePriority'
        team:
          $ref: '#/components/schemas/TeamSummary'
        owner:
          $ref: '#/components/schemas/UserSummary'
        project:
          $ref: '#/components/schemas/ProjectSummary'
        targetDate:
          type: string
          format: date
        startedAt:
          type: string
          format: date-time
        validatedAt:
          type: string
          format: date-time
        validatedBy:
          $ref: '#/components/schemas/UserSummary'
        validationNotes:
          type: string
        externalRefs:
          type: object
          additionalProperties:
            type: string
        tags:
          type: array
          items:
            type: string
        hypothesisCount:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    ValidateOutcomeRequest:
      type: object
      required: [validationNotes]
      properties:
        validationNotes:
          type: string
        finalMetrics:
          type: object
          additionalProperties: true

    InvalidateOutcomeRequest:
      type: object
      required: [reason]
      properties:
        reason:
          type: string
        finalMetrics:
          type: object
          additionalProperties: true

    # ── Key Results ───────────────────────────────────
    CreateKeyResultRequest:
      type: object
      required: [title, targetValue, unit]
      properties:
        title:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 1000
        targetValue:
          type: number
        currentValue:
          type: number
        unit:
          type: string
          maxLength: 50

    UpdateKeyResultRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 1000
        targetValue:
          type: number
        currentValue:
          type: number
        unit:
          type: string
          maxLength: 50

    KeyResultResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        outcomeId:
          type: string
          format: uuid
        title:
          type: string
        description:
          type: string
        targetValue:
          type: number
        currentValue:
          type: number
        unit:
          type: string
        progressPercent:
          type: number
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ── Hypotheses ────────────────────────────────────
    CreateHypothesisRequest:
      type: object
      required: [outcomeId, title, belief, expectedResult]
      properties:
        outcomeId:
          type: string
          format: uuid
        title:
          type: string
          minLength: 3
          maxLength: 500
        belief:
          type: string
          minLength: 10
          maxLength: 2000
        expectedResult:
          type: string
          maxLength: 2000
        measurementCriteria:
          type: string
          maxLength: 2000
        priority:
          $ref: '#/components/schemas/HypothesisPriority'
        effort:
          $ref: '#/components/schemas/TShirtSize'
        impact:
          $ref: '#/components/schemas/TShirtSize'
        confidence:
          $ref: '#/components/schemas/ConfidenceLevel'
        ownerId:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        experimentConfig:
          type: object
          additionalProperties: true
        tags:
          type: array
          maxItems: 20
          items:
            type: string

    UpdateHypothesisRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 500
        belief:
          type: string
        expectedResult:
          type: string
        measurementCriteria:
          type: string
        priority:
          $ref: '#/components/schemas/HypothesisPriority'
        effort:
          $ref: '#/components/schemas/TShirtSize'
        impact:
          $ref: '#/components/schemas/TShirtSize'
        confidence:
          $ref: '#/components/schemas/ConfidenceLevel'
        ownerId:
          type: string
          format: uuid
        experimentConfig:
          type: object
          additionalProperties: true
        tags:
          type: array
          items:
            type: string
        externalRefs:
          type: object
          additionalProperties:
            type: string

    TransitionHypothesisRequest:
      type: object
      required: [targetStatus]
      properties:
        targetStatus:
          $ref: '#/components/schemas/HypothesisStatus'
        reason:
          type: string
        blockedByDecisionId:
          type: string
          format: uuid

    ConcludeHypothesisRequest:
      type: object
      required: [conclusion]
      properties:
        conclusion:
          $ref: '#/components/schemas/HypothesisStatus'
        conclusionNotes:
          type: string
        experimentResults:
          type: object
          additionalProperties: true

    HypothesisResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        outcome:
          $ref: '#/components/schemas/OutcomeSummary'
        project:
          $ref: '#/components/schemas/ProjectSummary'
        title:
          type: string
        belief:
          type: string
        expectedResult:
          type: string
        measurementCriteria:
          type: string
        status:
          $ref: '#/components/schemas/HypothesisStatus'
        priority:
          $ref: '#/components/schemas/HypothesisPriority'
        effort:
          $ref: '#/components/schemas/TShirtSize'
        impact:
          $ref: '#/components/schemas/TShirtSize'
        confidence:
          $ref: '#/components/schemas/ConfidenceLevel'
        owner:
          $ref: '#/components/schemas/UserSummary'
        experimentConfig:
          type: object
          additionalProperties: true
        experimentResults:
          type: object
          additionalProperties: true
        blockedReason:
          type: string
        conclusionNotes:
          type: string
        externalRefs:
          type: object
          additionalProperties:
            type: string
        tags:
          type: array
          items:
            type: string
        startedAt:
          type: string
          format: date-time
        deployedAt:
          type: string
          format: date-time
        measuringStartedAt:
          type: string
          format: date-time
        concludedAt:
          type: string
          format: date-time
        concludedBy:
          $ref: '#/components/schemas/UserSummary'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ── Decisions ─────────────────────────────────────
    DecisionOption:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        description:
          type: string
        pros:
          type: array
          items:
            type: string
        cons:
          type: array
          items:
            type: string
        metadata:
          type: object
          additionalProperties: true

    BlockedItem:
      type: object
      properties:
        type:
          type: string
        id:
          type: string
          format: uuid
        title:
          type: string

    CreateDecisionRequest:
      type: object
      required: [title, priority]
      properties:
        title:
          type: string
          minLength: 3
          maxLength: 500
        description:
          type: string
          maxLength: 5000
        context:
          type: string
          maxLength: 5000
        options:
          type: array
          items:
            $ref: '#/components/schemas/DecisionOption'
        priority:
          $ref: '#/components/schemas/DecisionPriority'
        decisionType:
          $ref: '#/components/schemas/DecisionType'
        ownerId:
          type: string
          format: uuid
        assignedToId:
          type: string
          format: uuid
        outcomeId:
          type: string
          format: uuid
        hypothesisId:
          type: string
          format: uuid
        teamId:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        queueId:
          type: string
          format: uuid
        stakeholderId:
          type: string
          format: uuid
        slaHours:
          type: integer
          minimum: 1
          maximum: 720
        blockedItems:
          type: array
          items:
            $ref: '#/components/schemas/BlockedItem'
        tags:
          type: array
          maxItems: 20
          items:
            type: string

    UpdateDecisionRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 500
        description:
          type: string
        context:
          type: string
        options:
          type: array
          items:
            $ref: '#/components/schemas/DecisionOption'
        priority:
          $ref: '#/components/schemas/DecisionPriority'
        decisionType:
          $ref: '#/components/schemas/DecisionType'
        ownerId:
          type: string
          format: uuid
        assignedToId:
          type: string
          format: uuid
        outcomeId:
          type: string
          format: uuid
        hypothesisId:
          type: string
          format: uuid
        teamId:
          type: string
          format: uuid
        queueId:
          type: string
          format: uuid
        stakeholderId:
          type: string
          format: uuid
        slaHours:
          type: integer
        blockedItems:
          type: array
          items:
            $ref: '#/components/schemas/BlockedItem'
        externalRefs:
          type: object
          additionalProperties:
            type: string
        tags:
          type: array
          items:
            type: string

    ResolveDecisionRequest:
      type: object
      required: [rationale]
      properties:
        rationale:
          type: string
        selectedOption:
          $ref: '#/components/schemas/DecisionOption'
        selectedOptionId:
          type: string

    EscalateDecisionRequest:
      type: object
      required: [escalateToId]
      properties:
        escalateToId:
          type: string
          format: uuid
        reason:
          type: string

    DecisionResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        description:
          type: string
        context:
          type: string
        options:
          type: array
          items:
            $ref: '#/components/schemas/DecisionOption'
        status:
          $ref: '#/components/schemas/DecisionStatus'
        priority:
          $ref: '#/components/schemas/DecisionPriority'
        decisionType:
          $ref: '#/components/schemas/DecisionType'
        owner:
          $ref: '#/components/schemas/UserSummary'
        assignedTo:
          $ref: '#/components/schemas/UserSummary'
        outcome:
          $ref: '#/components/schemas/OutcomeSummary'
        hypothesis:
          $ref: '#/components/schemas/HypothesisSummary'
        team:
          $ref: '#/components/schemas/TeamSummary'
        project:
          $ref: '#/components/schemas/ProjectSummary'
        queue:
          $ref: '#/components/schemas/QueueSummary'
        stakeholder:
          $ref: '#/components/schemas/StakeholderSummary'
        slaHours:
          type: integer
        dueAt:
          type: string
          format: date-time
        overdue:
          type: boolean
        waitTimeHours:
          type: integer
          format: int64
        escalationLevel:
          type: integer
        escalatedAt:
          type: string
          format: date-time
        escalatedTo:
          $ref: '#/components/schemas/UserSummary'
        decidedBy:
          $ref: '#/components/schemas/UserSummary'
        decidedAt:
          type: string
          format: date-time
        decisionRationale:
          type: string
        selectedOption:
          $ref: '#/components/schemas/DecisionOption'
        resolution:
          type: string
        wasEscalated:
          type: boolean
        blockedItems:
          type: array
          items:
            $ref: '#/components/schemas/BlockedItem'
        commentCount:
          type: integer
        voteCount:
          type: integer
        externalRefs:
          type: object
          additionalProperties:
            type: string
        tags:
          type: array
          items:
            type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        votes:
          type: array
          items:
            $ref: '#/components/schemas/VoteResponse'
        comments:
          type: array
          items:
            $ref: '#/components/schemas/CommentResponse'

    DecisionQueueResponse:
      type: object
      properties:
        needsInput:
          type: array
          items:
            $ref: '#/components/schemas/DecisionResponse'
        underDiscussion:
          type: array
          items:
            $ref: '#/components/schemas/DecisionResponse'
        decided:
          type: array
          items:
            $ref: '#/components/schemas/DecisionResponse'
        totalPending:
          type: integer
          format: int64
        avgDecisionTimeHours:
          type: number
          format: double

    # ── Votes & Comments ──────────────────────────────
    CastVoteRequest:
      type: object
      required: [vote]
      properties:
        vote:
          $ref: '#/components/schemas/VoteType'
        comment:
          type: string
          maxLength: 1000

    VoteResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserSummary'
        vote:
          $ref: '#/components/schemas/VoteType'
        comment:
          type: string
        createdAt:
          type: string
          format: date-time

    VoteSummary:
      type: object
      properties:
        totalVotes:
          type: integer
        countByType:
          type: object
          additionalProperties:
            type: integer
            format: int64
        votes:
          type: array
          items:
            $ref: '#/components/schemas/VoteResponse'

    CreateCommentRequest:
      type: object
      required: [content]
      properties:
        content:
          type: string
        optionId:
          type: string
        parentId:
          type: string
          format: uuid

    UpdateCommentRequest:
      type: object
      required: [content]
      properties:
        content:
          type: string

    CommentResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        author:
          $ref: '#/components/schemas/UserSummary'
        content:
          type: string
        optionId:
          type: string
        parentId:
          type: string
          format: uuid
        edited:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ── Queues ────────────────────────────────────────
    CreateQueueRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 500
        isDefault:
          type: boolean
        slaConfig:
          type: object
          additionalProperties:
            type: integer

    UpdateQueueRequest:
      type: object
      properties:
        name:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 500
        isDefault:
          type: boolean
        slaConfig:
          type: object
          additionalProperties:
            type: integer

    QueueResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        isDefault:
          type: boolean
        slaConfig:
          type: object
          additionalProperties:
            type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ── Experiments ───────────────────────────────────
    CreateExperimentRequest:
      type: object
      required: [name, type]
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          maxLength: 5000
        type:
          $ref: '#/components/schemas/ExperimentType'
        projectId:
          type: string
          format: uuid
        hypothesisId:
          type: string
          format: uuid
        ownerId:
          type: string
          format: uuid
        durationDays:
          type: integer
        trafficSplit:
          type: string
        primaryMetric:
          type: string
        secondaryMetrics:
          type: array
          items:
            type: string
        audienceFilter:
          type: string
        sampleSizeTarget:
          type: integer

    UpdateExperimentRequest:
      type: object
      properties:
        name:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 5000
        type:
          $ref: '#/components/schemas/ExperimentType'
        projectId:
          type: string
          format: uuid
        hypothesisId:
          type: string
          format: uuid
        ownerId:
          type: string
          format: uuid
        durationDays:
          type: integer
        trafficSplit:
          type: string
        primaryMetric:
          type: string
        secondaryMetrics:
          type: array
          items:
            type: string
        audienceFilter:
          type: string
        sampleSizeTarget:
          type: integer

    RecordResultsRequest:
      type: object
      properties:
        controlValue:
          type: number
        variantValue:
          type: number
        confidenceLevel:
          type: number
        currentSampleSize:
          type: integer
        additionalResults:
          type: object
          additionalProperties: true

    ExperimentResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        type:
          $ref: '#/components/schemas/ExperimentType'
        status:
          $ref: '#/components/schemas/ExperimentStatus'
        config:
          type: object
          additionalProperties: true
        startDate:
          type: string
          format: date-time
        endDate:
          type: string
          format: date-time
        durationDays:
          type: integer
        results:
          type: object
          additionalProperties: true
        conclusion:
          type: string
        trafficSplit:
          type: string
        primaryMetric:
          type: string
        secondaryMetrics:
          type: array
          items:
            type: string
        audienceFilter:
          type: string
        sampleSizeTarget:
          type: integer
        currentSampleSize:
          type: integer
        controlValue:
          type: number
        variantValue:
          type: number
        confidenceLevel:
          type: number
        project:
          $ref: '#/components/schemas/ProjectSummary'
        hypothesis:
          $ref: '#/components/schemas/HypothesisSummary'
        owner:
          $ref: '#/components/schemas/UserSummary'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ── Teams ─────────────────────────────────────────
    CreateTeamRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
          maxLength: 200
        description:
          type: string
        iconUrl:
          type: string
        color:
          type: string
        leadId:
          type: string
          format: uuid

    UpdateTeamRequest:
      type: object
      properties:
        name:
          type: string
          maxLength: 200
        description:
          type: string
        iconUrl:
          type: string
        color:
          type: string
        leadId:
          type: string
          format: uuid
        active:
          type: boolean

    TeamResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        slug:
          type: string
        description:
          type: string
        iconUrl:
          type: string
        color:
          type: string
        lead:
          $ref: '#/components/schemas/UserSummary'
        memberCount:
          type: integer
        active:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    TeamDetailResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        slug:
          type: string
        description:
          type: string
        iconUrl:
          type: string
        color:
          type: string
        lead:
          $ref: '#/components/schemas/UserSummary'
        members:
          type: array
          items:
            $ref: '#/components/schemas/TeamMemberResponse'
        active:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    AddTeamMemberRequest:
      type: object
      required: [userId]
      properties:
        userId:
          type: string
          format: uuid
        role:
          $ref: '#/components/schemas/TeamMemberRole'

    UpdateTeamMemberRequest:
      type: object
      required: [role]
      properties:
        role:
          $ref: '#/components/schemas/TeamMemberRole'

    TeamMemberResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserSummary'
        teamRole:
          $ref: '#/components/schemas/TeamMemberRole'
        joinedAt:
          type: string
          format: date-time

    TeamWorkloadResponse:
      type: object
      properties:
        teamId:
          type: string
          format: uuid
        teamName:
          type: string
        totalMembers:
          type: integer
        totalStakeholders:
          type: integer
        pendingDecisionsAcrossTeam:
          type: integer
        members:
          type: array
          items:
            $ref: '#/components/schemas/MemberWorkload'

    MemberWorkload:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
        avatarUrl:
          type: string
        role:
          type: string
        decisionsPending:
          type: integer
        avgResponseTimeHours:
          type: number
          format: double
        hypothesesOwned:
          type: integer
        isActive:
          type: boolean

    # ── Stakeholders ──────────────────────────────────
    CreateStakeholderRequest:
      type: object
      required: [name, email]
      properties:
        name:
          type: string
          maxLength: 200
        email:
          type: string
          format: email
        title:
          type: string
        organization:
          type: string
        phone:
          type: string
        avatarUrl:
          type: string
        type:
          $ref: '#/components/schemas/StakeholderType'
        userId:
          type: string
          format: uuid
        expertise:
          type: array
          items:
            type: string
        preferredContactMethod:
          type: string
        availabilityNotes:
          type: string
        timezone:
          type: string
        notes:
          type: string
        externalRefs:
          type: object
          additionalProperties:
            type: string

    UpdateStakeholderRequest:
      type: object
      properties:
        name:
          type: string
          maxLength: 200
        email:
          type: string
          format: email
        title:
          type: string
        organization:
          type: string
        phone:
          type: string
        avatarUrl:
          type: string
        type:
          $ref: '#/components/schemas/StakeholderType'
        userId:
          type: string
          format: uuid
        expertise:
          type: array
          items:
            type: string
        preferredContactMethod:
          type: string
        availabilityNotes:
          type: string
        timezone:
          type: string
        notes:
          type: string
        externalRefs:
          type: object
          additionalProperties:
            type: string
        active:
          type: boolean

    StakeholderResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
        title:
          type: string
        organization:
          type: string
        phone:
          type: string
        avatarUrl:
          type: string
        type:
          $ref: '#/components/schemas/StakeholderType'
        user:
          $ref: '#/components/schemas/UserSummary'
        expertise:
          type: array
          items:
            type: string
        preferredContactMethod:
          type: string
        availabilityNotes:
          type: string
        timezone:
          type: string
        decisionsPending:
          type: integer
        decisionsCompleted:
          type: integer
        decisionsEscalated:
          type: integer
        avgResponseTimeHours:
          type: number
          format: double
        lastDecisionAt:
          type: string
          format: date-time
        active:
          type: boolean
        notes:
          type: string
        externalRefs:
          type: object
          additionalProperties:
            type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    StakeholderMetrics:
      type: object
      properties:
        stakeholderId:
          type: string
          format: uuid
        name:
          type: string
        decisionsPending:
          type: integer
        decisionsCompleted:
          type: integer
        decisionsEscalated:
          type: integer
        avgResponseTimeHours:
          type: number
          format: double
        escalationRate:
          type: number
          format: double
        lastDecisionAt:
          type: string
          format: date-time
        pendingDecisions:
          type: array
          items:
            $ref: '#/components/schemas/DecisionSummary'

    StakeholderLeaderboard:
      type: object
      properties:
        fastestResponders:
          type: array
          items:
            $ref: '#/components/schemas/StakeholderMetrics'
        mostActive:
          type: array
          items:
            $ref: '#/components/schemas/StakeholderMetrics'
        needingAttention:
          type: array
          items:
            $ref: '#/components/schemas/StakeholderMetrics'

    StakeholderScorecardResponse:
      type: object
      properties:
        stakeholders:
          type: array
          items:
            $ref: '#/components/schemas/ScorecardEntry'

    ScorecardEntry:
      type: object
      properties:
        stakeholderId:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
        avatarUrl:
          type: string
        decisionDomains:
          type: array
          items:
            type: string
        avgResponseTimeHours:
          type: number
          format: double
        teamAvgResponseTimeHours:
          type: number
          format: double
        decisionsPending:
          type: integer
        decisionsCompletedThisMonth:
          type: integer

    # ── Users ─────────────────────────────────────────
    UpdateUserRequest:
      type: object
      properties:
        firstName:
          type: string
        lastName:
          type: string
        title:
          type: string
        department:
          type: string
        avatarUrl:
          type: string
        roleId:
          type: string
          format: uuid
        managerId:
          type: string
          format: uuid
        active:
          type: boolean

    UserResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        fullName:
          type: string
        title:
          type: string
        department:
          type: string
        avatarUrl:
          type: string
        role:
          $ref: '#/components/schemas/RoleResponse'
        manager:
          $ref: '#/components/schemas/UserSummary'
        active:
          type: boolean
        lastLoginAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time

    # ── Roles ─────────────────────────────────────────
    CreateRoleRequest:
      type: object
      required: [code, name, category, level]
      properties:
        code:
          type: string
        name:
          type: string
        description:
          type: string
        category:
          $ref: '#/components/schemas/RoleCategory'
        level:
          $ref: '#/components/schemas/RoleLevel'
        permissionCodes:
          type: array
          items:
            type: string

    RoleResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        code:
          type: string
        name:
          type: string
        description:
          type: string
        category:
          $ref: '#/components/schemas/RoleCategory'
        level:
          $ref: '#/components/schemas/RoleLevel'
        permissions:
          type: array
          items:
            type: string

    # ── Audit ─────────────────────────────────────────
    AuditLog:
      type: object
      properties:
        id:
          type: string
          format: uuid
        tenantId:
          type: string
          format: uuid
        actorId:
          type: string
          format: uuid
        actorEmail:
          type: string
        actorName:
          type: string
        action:
          $ref: '#/components/schemas/AuditAction'
        entityType:
          type: string
        entityId:
          type: string
          format: uuid
        entityTitle:
          type: string
        description:
          type: string
        oldValues:
          type: string
        newValues:
          type: string
        ipAddress:
          type: string
        userAgent:
          type: string
        requestId:
          type: string
        timestamp:
          type: string
          format: date-time

    # ── Enums ─────────────────────────────────────────
    ProjectStatus:
      type: string
      enum: [ACTIVE, PLANNING, COMPLETED, ARCHIVED]

    OutcomeStatus:
      type: string
      enum: [DRAFT, NOT_STARTED, IN_PROGRESS, VALIDATING, VALIDATED, INVALIDATED, ABANDONED]

    OutcomePriority:
      type: string
      enum: [CRITICAL, HIGH, MEDIUM, LOW, BACKLOG]

    HypothesisStatus:
      type: string
      enum: [DRAFT, READY, BLOCKED, BUILDING, DEPLOYED, MEASURING, VALIDATED, INVALIDATED, ABANDONED]

    HypothesisPriority:
      type: string
      enum: [CRITICAL, HIGH, MEDIUM, LOW]

    TShirtSize:
      type: string
      enum: [XS, S, M, L, XL]

    ConfidenceLevel:
      type: string
      enum: [LOW, MEDIUM, HIGH]

    DecisionStatus:
      type: string
      enum: [NEEDS_INPUT, UNDER_DISCUSSION, DECIDED, IMPLEMENTED, DEFERRED, CANCELLED]

    DecisionPriority:
      type: string
      enum: [BLOCKING, HIGH, NORMAL, LOW]

    DecisionType:
      type: string
      enum: [PRODUCT, UX, TECHNICAL, ARCHITECTURAL, STRATEGIC, OPERATIONAL, RESOURCE, SCOPE, TIMELINE]

    VoteType:
      type: string
      enum: [APPROVE, REJECT, ABSTAIN, NEEDS_MORE_INFO]

    ExperimentStatus:
      type: string
      enum: [DRAFT, RUNNING, CONCLUDED, CANCELLED]

    ExperimentType:
      type: string
      enum: [A_B_TEST, FEATURE_FLAG, CANARY, MANUAL]

    TeamMemberRole:
      type: string
      enum: [LEAD, MEMBER, OBSERVER]

    StakeholderType:
      type: string
      enum: [INTERNAL, EXTERNAL, EXECUTIVE, CUSTOMER, REGULATORY, TECHNICAL]

    RoleCategory:
      type: string
      enum: [SYSTEM, EXECUTIVE, PRODUCT, ENGINEERING, UX, QA, DATA, BUSINESS, STAKEHOLDER, CUSTOM]

    RoleLevel:
      type: string
      enum: [L1_INDIVIDUAL, L2_SENIOR, L3_LEAD, L4_MANAGER, L5_SENIOR_MANAGER, L6_VP, L7_SVP, L8_CXXX, L9_OWNER]

    AuditAction:
      type: string
      enum:
        - CREATE
        - READ
        - UPDATE
        - DELETE
        - STATUS_CHANGE
        - DECISION_RESOLVED
        - DECISION_ESCALATED
        - DECISION_ASSIGNED
        - DECISION_COMMENTED
        - OUTCOME_VALIDATED
        - OUTCOME_INVALIDATED
        - HYPOTHESIS_TRANSITIONED
        - HYPOTHESIS_CONCLUDED
        - HYPOTHESIS_BLOCKED
        - HYPOTHESIS_UNBLOCKED
        - LOGIN
        - LOGOUT
        - PASSWORD_CHANGED
        - USER_CREATED
        - USER_DEACTIVATED
        - ROLE_ASSIGNED
        - TEAM_MEMBER_ADDED
        - TEAM_MEMBER_REMOVED

    # ── Pagination wrappers (Spring Page) ─────────────
    PageProjectResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/ProjectResponse'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        empty:
          type: boolean

    PageOutcomeResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/OutcomeResponse'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        empty:
          type: boolean

    PageHypothesisResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/HypothesisResponse'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        empty:
          type: boolean

    PageDecisionResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/DecisionResponse'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        empty:
          type: boolean

    PageExperimentResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/ExperimentResponse'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        empty:
          type: boolean

    PageTeamResponse:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/TeamResponse'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        empty:
          type: boolean

    PageAuditLog:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/AuditLog'
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
        size:
          type: integer
        number:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        empty:
          type: boolean
